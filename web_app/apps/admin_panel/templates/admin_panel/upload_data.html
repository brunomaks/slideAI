{% extends 'admin_panel/base.html' %}

{% block title %}Upload Data{% endblock %}

{% block content %}
<h1 style="margin-bottom: 2rem;">Upload Training Data</h1>

<div class="card">
    <h2>Upload Instructions</h2>
    <p style="margin-top: 1rem; line-height: 1.8;">
        Upload a JSON file containing processed landmarks data.<br>
        The file should be a list of objects, each containing:
    <ul>
        <li><code>gesture</code>: Label string (e.g., "like", "stop")</li>
        <li><code>landmarks</code>: List of 21 [x, y] coordinates</li>
    </ul>
    </p>
    <p style="margin-top: 1rem;">
        <strong>Supported formats:</strong> JSON
    </p>
</div>

<div class="card">
    <h2>Upload Form</h2>
    <form method="post" enctype="multipart/form-data" id="upload-form">
        {% csrf_token %}

        <div class="form-group">
            {{ form.data_file.label_tag }}
            {{ form.data_file }}
            <small>{{ form.data_file.help_text }}</small>
        </div>

        <button type="submit" class="btn btn-primary" id="submit-btn">Upload Data</button>
        <a href="{% url 'admin_panel:view_dataset' %}" class="btn btn-secondary">View Dataset Statistics</a>

        <div id="upload-spinner" style="display: none; margin-top: 1rem; text-align: center;">
            <div style="
                display: inline-block;
                width: 40px;
                height: 40px;
                border: 4px solid rgba(102, 126, 234, 0.3);
                border-top-color: #667eea;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            "></div>
            <p style="margin-top: 1rem; color: #667eea; font-weight: bold;">
                Processing upload... This may take several minutes for large datasets.
            </p>
        </div>
    </form>
</div>

<style>
    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }
</style>

<script>
    document.getElementById('upload-form').addEventListener('submit', function () {
        document.getElementById('submit-btn').disabled = true;
        document.getElementById('upload-spinner').style.display = 'block';
    });
</script>

{% endblock %}